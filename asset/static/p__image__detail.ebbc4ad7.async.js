"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3357],{80821:function(U,b,n){n.d(b,{Z:function(){return T}});var y=n(5574),a=n.n(y),D=n(24963),_=n(86738),r=n(14726),O=n(83062),c=n(67294),C=n(85893);function T(i){var E=(0,c.useState)(!1),M=a()(E,2),P=M[0],f=M[1],g=(0,c.useContext)(D.Z),d=g.lang,u=g.notice,B=g.message,l=function(){f(!0),i.action().then(function(I){if(f(!1),typeof i.onSuccess=="function"&&i.onSuccess(I),i.messageSuccess){var R="";typeof i.messageSuccess=="function"?R=i.messageSuccess(I):R=i.messageSuccess,R.indexOf(".")>-1&&(R=d(R)),i.asynced?B.info(R):B.success(R)}}).catch(function(I){f(!1),typeof i.onError=="function"&&i.onError(I)})};return i.confirm?(0,C.jsx)(_.Z,{style:{width:500},title:i.confirmTitle?i.confirmTitle:d("notification.title.tip"),description:i.confirm,onConfirm:l,okText:"Yes",cancelText:"No",children:(0,C.jsx)(r.ZP,{disabled:i.disabled,icon:i.icon,loading:P,danger:i.danger,type:i.type,children:i.children})}):(0,C.jsx)(O.Z,{title:i.tips,children:(0,C.jsx)(r.ZP,{disabled:i.disabled,icon:i.icon,loading:P,onClick:l,danger:i.danger,type:i.type,children:i.children})})}},96042:function(U,b,n){n.d(b,{Z:function(){return T}});var y=n(97857),a=n.n(y),D=n(5574),_=n.n(D),r=n(75870),O=n(34041),c=n(67294),C=n(85893);function T(i){var E=(0,c.useState)([]),M=_()(E,2),P=M[0],f=M[1];(0,c.useEffect)(function(){(0,r.Ot)().then(function(d){console.log(d),d&&f(d.data.list)})},[]);var g={};return i.multiple&&(g.mode="multiple"),i.top&&(g.placement="topLeft"),(0,C.jsx)(O.Z,a()({onChange:function(u){if(Array.isArray(u)){var B=u.map(function(l){return P[l]});i.onChangeList&&i.onChangeList(B)}else i.onChange&&i.onChange(P[u])},placeholder:"\u9009\u62E9\u955C\u50CF\u4ED3\u5E93\uFF0C\u672C\u5730\u4F7F\u7528\u7559\u7A7A\u5373\u53EF",options:P.map(function(d,u){return{value:u,label:d.title+"("+d.serverAddress+")"}})},g))}},24963:function(U,b,n){var y=n(67294),a=(0,y.createContext)({});b.Z=a},70977:function(U,b,n){n.r(b),n.d(b,{default:function(){return ne}});var y=n(5574),a=n.n(y),D=n(3393),_=n(43425),r=n(58638),O=n(1912),c=n(87784),C=n(40666),T=n(77171),i=n(48689),E=n(45742),M=n(38345),P=n(7529),f=n(97269),g=n(62370),d=n(5966),u=n(54006),B=n(31418),l=n(42075),S=n(96074),I=n(66309),R=n(25593),h=n(26412),Z=n(63490),L=n(67294),o=n(80821),j=n(5251),p=n(93162),s=n.n(p),Q=n(18148),k=n(75870),q=n(96042),ee=n(24963),t=n(85893);function ne(){var F,$=(0,L.useContext)(ee.Z),te=$.message,re=$.notice,z=$.lang,ae=(0,L.useState)(),Y=a()(ae,2),e=Y[0],se=Y[1],H=(0,u.useParams)(),oe=B.Z.useApp(),de=(0,u.useIntl)(),N=(0,L.useRef)(),ue=(0,L.useState)(0),X=a()(ue,2),K=X[0],G=X[1],ie=(0,u.useNavigate)(),_e=(0,L.useState)([]),V=a()(_e,2),ce=V[0],le=V[1];return(0,L.useEffect)(function(){H.id&&(0,D.YU)({md5:H.id}).then(function(m){se(m.data)}),(0,k.Ot)().then(function(m){m&&le(m.data.list)})},[K]),(0,t.jsx)("div",{children:(0,t.jsxs)(M.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsx)(M.Z,{title:(0,t.jsx)(_.Z,{}),subTitle:"\u5E38\u7528\u64CD\u4F5C",headerBordered:!0,bordered:!0,children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(o.Z,{icon:(0,t.jsx)(r.Z,{}),action:function(){var v;return(0,D.Rb)({md5:(v=e==null?void 0:e.info.RepoTags)!==null&&v!==void 0?v:[""]})},onSuccess:function(v){var A=new Blob([v],{type:"application/tar"});(0,p.saveAs)(A,(e==null?void 0:e.info.RepoTags.join("-"))+".tar")},messageSuccess:"\u5BFC\u51FA\u6210\u529F",children:"\u5BFC\u51FA"}),(0,t.jsx)(o.Z,{icon:(0,t.jsx)(O.Z,{}),action:function(){var v;return(0,D.Gb)({tag:(v=e==null?void 0:e.info.RepoTags[0])!==null&&v!==void 0?v:"",type:"push",asLatest:!0})},type:"primary",messageSuccess:"image.pushed",onSuccess:function(){G(K+1)},children:"Push As Latest"}),(0,t.jsx)(S.Z,{}),(0,t.jsx)(o.Z,{icon:(0,t.jsx)(c.Z,{}),danger:!0,type:"primary",action:function(){var v;return(0,Q.ao)({md5:[(v=e==null?void 0:e.info.Id)!==null&&v!==void 0?v:""],force:!0})},onSuccess:function(){ie("/image/list")},confirm:"\u662F\u5426\u8981\u505C\u6B62\u8BE5\u955C\u50CF\u4E0B\u7684\u5BB9\u5668\u5E76\u5F3A\u5236\u5220\u9664\uFF1F",messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u5F3A\u5236\u5220\u9664"})]})}),(0,t.jsx)(M.Z,{bordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"Tag \u5217\u8868",children:(0,t.jsx)(P.Rs,{grid:{gutter:40,column:2},headerTitle:!1,metas:{content:{render:function(v,A,x){return(0,t.jsx)(I.Z,{color:"blue",children:(0,t.jsx)(R.Z.Text,{copyable:!0,children:A})},x)}},title:{render:function(v,A,x){return(0,t.jsxs)(l.Z,{children:[(0,t.jsxs)(o.Z,{action:function(){return(0,D.Gb)({tag:A,type:"push"})},messageSuccess:"image.pushed",children:[(0,t.jsx)(O.Z,{})," Push"]}),(0,t.jsxs)(o.Z,{action:function(){return(0,D.Gb)({tag:A,type:"pull"})},messageSuccess:"image.pulled",children:[(0,t.jsx)(T.Z,{})," Pull"]}),(0,t.jsx)(o.Z,{action:function(){return(0,D.Pn)({tag:A})},onSuccess:function(J){return G(K+1),!0},messageSuccess:"tag.delete",confirm:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6807\u7B7E",children:(0,t.jsx)(i.Z,{})})]},x)}}},dataSource:e==null?void 0:e.info.RepoTags})}),(0,t.jsx)(M.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"\u65B0\u589E Tag",children:(0,t.jsxs)(f.A,{formRef:N,onFinish:function(v){return new Promise(function(A,x){var W;return(!e||!(e!=null&&e.info))&&(re.error(z("image.notFound")),x(!0)),(0,D._U)({md5:(W=e==null?void 0:e.info.Id)!==null&&W!==void 0?W:"",tag:(v.imageRespo?v.imageRespo.serverAddress+"/":"")+v.imageTag}).then(function(J){var w;te.success(z("tag.add"),J.data.tag),G(K+1),(w=N.current)===null||w===void 0||w.resetFields(),A(!0)})})},children:[(0,t.jsx)(g.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,t.jsxs)(t.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,t.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,t.jsx)(q.Z,{})}),(0,t.jsx)(d.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CF\u540D\u79F0",name:"imageTag",tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag"})]})}),(0,t.jsx)(M.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(E.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,t.jsxs)(h.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(h.Z.Item,{label:"ID",children:e==null?void 0:e.info.Id}),(0,t.jsx)(h.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,t.jsx)(h.Z.Item,{label:"Size",children:(0,j.FI)((F=e==null?void 0:e.info.Size)!==null&&F!==void 0?F:0)}),(0,t.jsx)(h.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,t.jsxs)(h.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,t.jsx)(h.Z.Item,{label:"Labels",children:(0,t.jsx)(h.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(m){return(0,t.jsx)(h.Z.Item,{label:m,children:(0,t.jsx)(R.Z.Text,{style:{width:"400px"},ellipsis:{tooltip:e==null?void 0:e.info.Config.Labels[m]},children:e==null?void 0:e.info.Config.Labels[m]})},m)})})})]})}),(0,t.jsx)(M.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(E.Z,{}),subTitle:"Dockerfile \u8BE6\u60C5",children:(0,t.jsxs)(h.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(h.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,t.jsx)(h.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,t.jsx)(h.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(m){return(0,t.jsx)(I.Z,{color:"gray",children:m},m)})}),(0,t.jsx)(h.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(m){return(0,t.jsx)(I.Z,{color:"gray",children:m},m)})}),(0,t.jsx)(h.Z.Item,{label:"Env",children:(0,t.jsx)(h.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(m,v){var A=m.split("=");return(0,t.jsx)(h.Z.Item,{label:A[0],children:A[1]},v)}))})})]})}),(0,t.jsxs)(M.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(E.Z,{}),subTitle:"Layers",children:[(0,t.jsx)(Z.Z,{rowKey:"CreatedBy",dataSource:e==null?void 0:e.layer.reverse(),columns:[{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy"}]}),";"]})]})})}},3393:function(U,b,n){n.d(b,{Gb:function(){return C},Pn:function(){return M},Rb:function(){return f},YU:function(){return O},_U:function(){return i}});var y=n(15009),a=n.n(y),D=n(99289),_=n.n(D),r=n(54006);function O(d){return c.apply(this,arguments)}function c(){return c=_()(a()().mark(function d(u){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/get-detail",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),c.apply(this,arguments)}function C(d){return T.apply(this,arguments)}function T(){return T=_()(a()().mark(function d(u){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-remote",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),T.apply(this,arguments)}function i(d){return E.apply(this,arguments)}function E(){return E=_()(a()().mark(function d(u){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-add",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),E.apply(this,arguments)}function M(d){return P.apply(this,arguments)}function P(){return P=_()(a()().mark(function d(u){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-delete",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),P.apply(this,arguments)}function f(d){return g.apply(this,arguments)}function g(){return g=_()(a()().mark(function d(u){return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/export",{method:"POST",data:u,responseType:"blob"}));case 1:case"end":return l.stop()}},d)})),g.apply(this,arguments)}},18148:function(U,b,n){n.d(b,{$q:function(){return f},Fj:function(){return R},KG:function(){return O},KX:function(){return Z},T8:function(){return M},Xn:function(){return i},ao:function(){return d},c5:function(){return S},c7:function(){return B}});var y=n(15009),a=n.n(y),D=n(99289),_=n.n(D),r=n(54006);function O(o){return c.apply(this,arguments)}function c(){return c=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,r.request)("/api/app/image/get-list",{method:"POST",data:j}));case 1:case"end":return s.stop()}},o)})),c.apply(this,arguments)}function C(o){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime().mark(function o(j){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,request("/api/app/log/image-build",{method:"POST",data:j});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},o)})),T.apply(this,arguments)}function i(o){return E.apply(this,arguments)}function E(){return E=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,r.request)("/api/app/image/get-list-build",{method:"POST",data:j}));case 1:case"end":return s.stop()}},o)})),E.apply(this,arguments)}function M(o){return P.apply(this,arguments)}function P(){return P=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.request)("/api/app/image/get-build-task",{method:"POST",data:j});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},o)})),P.apply(this,arguments)}function f(o){return g.apply(this,arguments)}function g(){return g=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.request)("/api/app/image/delete-build-task",{method:"POST",data:j});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},o)})),g.apply(this,arguments)}function d(o){return u.apply(this,arguments)}function u(){return u=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.request)("/api/app/image/image-delete",{method:"POST",data:j});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},o)})),u.apply(this,arguments)}function B(){return l.apply(this,arguments)}function l(){return l=_()(a()().mark(function o(){return a()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,r.request)("/api/app/image/image-prune",{method:"POST"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},o)})),l.apply(this,arguments)}function S(){return I.apply(this,arguments)}function I(){return I=_()(a()().mark(function o(){return a()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,r.request)("/api/app/image/build-prune",{method:"POST"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},o)})),I.apply(this,arguments)}function R(o){return h.apply(this,arguments)}function h(){return h=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.request)("/api/app/image/update-title",{method:"POST",data:j});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},o)})),h.apply(this,arguments)}function Z(o){return L.apply(this,arguments)}function L(){return L=_()(a()().mark(function o(j){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,r.request)("/api/app/image/tag-sync",{method:"POST",data:j}));case 1:case"end":return s.stop()}},o)})),L.apply(this,arguments)}},75870:function(U,b,n){n.d(b,{Ot:function(){return O},ZH:function(){return C},ix:function(){return i},t1:function(){return M}});var y=n(15009),a=n.n(y),D=n(99289),_=n.n(D),r=n(54006);function O(f){return c.apply(this,arguments)}function c(){return c=_()(a()().mark(function f(g){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/get-list",{method:"POST",data:g}));case 1:case"end":return u.stop()}},f)})),c.apply(this,arguments)}function C(f){return T.apply(this,arguments)}function T(){return T=_()(a()().mark(function f(g){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/create",{method:"POST",data:g}));case 1:case"end":return u.stop()}},f)})),T.apply(this,arguments)}function i(f){return E.apply(this,arguments)}function E(){return E=_()(a()().mark(function f(g){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/delete",{method:"POST",data:g}));case 1:case"end":return u.stop()}},f)})),E.apply(this,arguments)}function M(f){return P.apply(this,arguments)}function P(){return P=_()(a()().mark(function f(g){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/get-detail",{method:"POST",data:g}));case 1:case"end":return u.stop()}},f)})),P.apply(this,arguments)}},5251:function(U,b,n){n.d(b,{FI:function(){return a},ZM:function(){return D}});function y(_){return _.trim()}function a(_){var r="";_<.1*1024?r=_.toFixed(2)+"B":_<.1*1024*1024?r=(_/1024).toFixed(2)+"KB":_<1*1024*1024*1024?r=(_/(1024*1024)).toFixed(2)+"MB":r=(_/(1024*1024*1024)).toFixed(2)+"GB";var O=r+"",c=O.indexOf("."),C=O.substring(c+1,c+3);return C=="00"?O.substring(0,c)+O.substr(c+3,2):r}function D(_){if(_){var r=new Date(_),O=r.getFullYear()+"-",c=(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"-",C=(r.getDate()<10?"0"+r.getDate():r.getDate())+" ",T=(r.getHours()<10?"0"+r.getHours():r.getHours())+":",i=(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())+":",E=r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds();return O+c+C+T+i+E}}}}]);
