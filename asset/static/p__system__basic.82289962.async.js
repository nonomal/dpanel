"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1050],{12119:function(S,P,e){e.d(P,{Z:function(){return m}});var d=e(87462),r=e(67294),F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},h=F,R=e(84089),A=function(c,T){return r.createElement(R.Z,(0,d.Z)({},c,{ref:T,icon:h}))},M=r.forwardRef(A),m=M},52688:function(S,P,e){var d=e(1413),r=e(45987),F=e(67294),h=e(34692),R=e(85893),A=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],M=F.forwardRef(function(m,g){var c=m.fieldProps,T=m.unCheckedChildren,b=m.checkedChildren,C=m.proFieldProps,L=(0,r.Z)(m,A);return(0,R.jsx)(h.Z,(0,d.Z)({valueType:"switch",fieldProps:(0,d.Z)({unCheckedChildren:T,checkedChildren:b},c),ref:g,valuePropName:"checked",proFieldProps:C,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},L))});P.Z=M},5966:function(S,P,e){var d=e(97685),r=e(1413),F=e(45987),h=e(21770),R=e(72723),A=e(55241),M=e(97435),m=e(67294),g=e(34692),c=e(85893),T=["fieldProps","proFieldProps"],b=["fieldProps","proFieldProps"],C="text",L=function(u){var t=u.fieldProps,x=u.proFieldProps,E=(0,F.Z)(u,T);return(0,c.jsx)(g.Z,(0,r.Z)({valueType:C,fieldProps:t,filedConfig:{valueType:C},proFieldProps:x},E))},J=function(u){var t=(0,h.Z)(u.open||!1,{value:u.open,onChange:u.onOpenChange}),x=(0,d.Z)(t,2),E=x[0],U=x[1];return(0,c.jsx)(R.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function($){var O,y=$.getFieldValue(u.name||[]);return(0,c.jsx)(A.Z,(0,r.Z)((0,r.Z)({getPopupContainer:function(i){return i&&i.parentNode?i.parentNode:i},onOpenChange:function(i){return U(i)},content:(0,c.jsxs)("div",{style:{padding:"4px 0"},children:[(O=u.statusRender)===null||O===void 0?void 0:O.call(u,y),u.strengthText?(0,c.jsx)("div",{style:{marginTop:10},children:(0,c.jsx)("span",{children:u.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},u.popoverProps),{},{open:E,children:u.children}))}})},Q=function(u){var t=u.fieldProps,x=u.proFieldProps,E=(0,F.Z)(u,b),U=(0,m.useState)(!1),W=(0,d.Z)(U,2),$=W[0],O=W[1];return t!=null&&t.statusRender&&E.name?(0,c.jsx)(J,{name:E.name,statusRender:t==null?void 0:t.statusRender,popoverProps:t==null?void 0:t.popoverProps,strengthText:t==null?void 0:t.strengthText,open:$,onOpenChange:O,children:(0,c.jsx)("div",{children:(0,c.jsx)(g.Z,(0,r.Z)({valueType:"password",fieldProps:(0,r.Z)((0,r.Z)({},(0,M.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(B){var i;t==null||(i=t.onBlur)===null||i===void 0||i.call(t,B),O(!1)},onClick:function(B){var i;t==null||(i=t.onClick)===null||i===void 0||i.call(t,B),O(!0)}}),proFieldProps:x,filedConfig:{valueType:C}},E))})}):(0,c.jsx)(g.Z,(0,r.Z)({valueType:"password",fieldProps:t,proFieldProps:x,filedConfig:{valueType:C}},E))},K=L;K.Password=Q,K.displayName="ProFormComponent",P.Z=K},12044:function(S,P,e){e.d(P,{j:function(){return F}});var d=e(34155),r=typeof d!="undefined"&&d.versions!=null&&d.versions.node!=null,F=function(){return typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.matchMedia!="undefined"&&!r}},24963:function(S,P,e){var d=e(67294),r=(0,d.createContext)({});P.Z=r},83163:function(S,P,e){e.r(P),e.d(P,{default:function(){return ue}});var d=e(15009),r=e.n(d),F=e(99289),h=e.n(F),R=e(5574),A=e.n(R),M=e(24963),m=e(87662),g=e(54006);function c(Z){return T.apply(this,arguments)}function T(){return T=h()(r()().mark(function Z(D){return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",(0,g.request)("/api/pro/two-fa/enable",{method:"POST",data:D}));case 1:case"end":return V.stop()}},Z)})),T.apply(this,arguments)}function b(){return C.apply(this,arguments)}function C(){return C=h()(r()().mark(function Z(){return r()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,g.request)("/api/pro/two-fa/get-setting",{method:"POST"}));case 1:case"end":return j.stop()}},Z)})),C.apply(this,arguments)}var L=e(87547),J=e(86548),Q=e(97937),K=e(12119),N=e(87462),u=e(67294),t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M956.9 845.1L896.4 632V168c0-17.7-14.3-32-32-32h-704c-17.7 0-32 14.3-32 32v464L67.9 845.1C60.4 866 75.8 888 98 888h828.8c22.2 0 37.6-22 30.1-42.9zM200.4 208h624v395h-624V208zm228.3 608l8.1-37h150.3l8.1 37H428.7zm224 0l-19.1-86.7c-.8-3.7-4.1-6.3-7.8-6.3H398.2c-3.8 0-7 2.6-7.8 6.3L371.3 816H151l42.3-149h638.2l42.3 149H652.7z"}}]},name:"laptop",theme:"outlined"},x=t,E=e(84089),U=function(D,j){return u.createElement(E.Z,(0,N.Z)({},D,{ref:j,icon:x}))},W=u.forwardRef(U),$=W,O=e(90078),y=e(38345),B=e(97269),i=e(97462),I=e(5966),te=e(52688),_=e(62370),q=e(14726),ae=e(98163),a=e(85893);function ue(){var Z=(0,u.useContext)(M.Z),D=Z.message,j=Z.notice,V=Z.lang,H=(0,u.useRef)(),G=(0,u.useRef)(),X=(0,u.useRef)(),z=(0,g.useModel)("@@initialState"),Y=z.initialState,de=z.loading,ce=z.error,se=z.refresh,ve=z.setInitialState,le=(0,g.useAccess)(),oe=(0,u.useState)(0),ee=A()(oe,2),re=ee[0],ie=ee[1],k=3,ne=function(){var v=h()(r()().mark(function l(){var n,o,s,w;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,m.pe)({groupName:"setting",name:"server"});case 2:s=f.sent,(n=G.current)===null||n===void 0||n.setFieldsValue({serverIp:(o=s.data.setting.value.serverIp)!==null&&o!==void 0?o:""}),s.data.setting.value.requestTimeout&&((w=G.current)===null||w===void 0||w.setFieldsValue({requestTimeout:s.data.setting.value.requestTimeout}));case 5:case"end":return f.stop()}},l)}));return function(){return v.apply(this,arguments)}}();return(0,u.useEffect)(function(){b().then(function(v){var l;(l=X.current)===null||l===void 0||l.setFieldsValue({enable:v.data.enable,email:v.data.email,qrcode:v.data.qrcode})})},[re]),(0,a.jsx)(O._z,{children:(0,a.jsxs)(y.Z,{direction:"column",gutter:[0,10],children:[(0,a.jsx)(y.Z,{bordered:!0,headerBordered:!0,title:(0,a.jsx)(L.Z,{}),subTitle:"\u7BA1\u7406\u5458",children:(0,a.jsxs)(B.A,{layout:"horizontal",labelAlign:"right",labelCol:{span:k,offset:0},formRef:H,onFinish:function(){var v=h()(r()().mark(function l(n){var o,s;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,m.Jn)({username:n.username,password:n.password,newPassword:n.newPassword});case 2:if(o=p.sent,!(o&&o.data)){p.next=9;break}return(s=H.current)===null||s===void 0||s.resetFields(),D.success("\u4FEE\u6539\u7BA1\u7406\u5458\u7528\u6237\u540D\u548C\u5BC6\u7801\u6210\u529F"),localStorage.removeItem("token"),se(),p.abrupt("return",!0);case 9:case"end":return p.stop()}},l)}));return function(l){return v.apply(this,arguments)}}(),children:[(0,a.jsx)(i.Z,{name:["enableUsername"],children:function(l){var n=l.enableUsername;return(0,a.jsx)(I.Z,{label:"\u7528\u6237\u540D",name:"username",style:{width:"80%"},initialValue:Y==null?void 0:Y.user.username,disabled:!n,addonAfter:[(0,a.jsx)(q.ZP,{type:"link",hidden:!!n,icon:(0,a.jsx)(J.Z,{}),onClick:function(){var s;(s=H.current)===null||s===void 0||s.setFieldValue("enableUsername",!0)}},"editBtn"),(0,a.jsx)(q.ZP,{type:"link",hidden:!n,icon:(0,a.jsx)(Q.Z,{}),onClick:function(){var s;(s=H.current)===null||s===void 0||s.setFieldValue("enableUsername",!1)}},"closeBtn")]},"username")}}),(0,a.jsx)(I.Z.Password,{label:"\u5F53\u524D\u5BC6\u7801",name:"password",placeholder:"\u8F93\u5165\u7BA1\u7406\u5458\u5F53\u524D\u5BC6\u7801",rules:[{required:!0}]},"password"),(0,a.jsx)(I.Z.Password,{label:"\u65B0\u5BC6\u7801",name:"newPassword"},"newPasword"),(0,a.jsx)(i.Z,{name:["newPassword"],children:function(l){var n=l.newPassword;return(0,a.jsx)(I.Z.Password,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",name:"newPassword2",dependencies:["newPassword"],rules:[{required:typeof n!="undefined"&&n!=""},function(o){var s=o.getFieldValue;return{validator:function(p,f){return!f||s("newPassword")===f?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"))}}}]},"newPasword2")}})]})}),le.canSeeTwoFa&&(0,a.jsx)(y.Z,{bordered:!0,headerBordered:!0,title:(0,a.jsx)(K.Z,{}),subTitle:"\u767B\u5F55\u53CC\u56E0\u7D20\u914D\u7F6E",children:(0,a.jsxs)(B.A,{onFinish:function(){var v=h()(r()().mark(function l(n){var o,s;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,c({email:n.email,enable:n.enable});case 2:o=p.sent,o&&o.data.qrcode&&((s=X.current)===null||s===void 0||s.setFieldValue("qrcode",o.data.qrcode)),ie(re+1);case 5:case"end":return p.stop()}},l)}));return function(l){return v.apply(this,arguments)}}(),formRef:X,layout:"horizontal",labelAlign:"right",labelCol:{span:k,offset:0},children:[(0,a.jsx)(te.Z,{label:"\u5F00\u542F",name:"enable"}),(0,a.jsx)(I.Z,{label:"\u90AE\u7BB1",name:"email",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u90AE\u7BB1",rules:[{required:!0},{type:"email"}]}),(0,a.jsx)(_.Z,{name:"qrcode",hidden:!0}),(0,a.jsx)(i.Z,{name:["qrcode"],children:function(l){var n=l.qrcode;if(n)return(0,a.jsx)(_.Z,{label:" ",tooltip:"\u4F7F\u7528\u652F\u6301 2fa \u7684\u9A8C\u8BC1 App \u626B\u7801\u8BE5\u4E8C\u7EF4\u7801",children:(0,a.jsx)(ae.Z,{style:{border:"#d1d9e0b3 solid 1px",padding:"10px",borderRadius:"10px"},width:200,src:"data:image/png;base64,".concat(n)})})}})]})}),(0,a.jsx)(y.Z,{bordered:!0,headerBordered:!0,title:(0,a.jsx)($,{}),subTitle:"\u670D\u52A1\u5668\u914D\u7F6E",children:(0,a.jsx)(B.A,{layout:"horizontal",labelAlign:"right",labelCol:{span:k,offset:0},formRef:G,onInit:h()(r()().mark(function v(){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return ne(),n.abrupt("return",!0);case 2:case"end":return n.stop()}},v)})),onFinish:function(){var v=h()(r()().mark(function l(n){var o,s,w;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s={groupName:"setting",name:"server",value:{serverIp:n.serverIp}},n.requestTimeout&&(s.value.requestTimeout=n.requestTimeout),f.next=4,(0,m.KU)(s);case 4:return w=f.sent,(o=G.current)===null||o===void 0||o.resetFields(),ne(),D.success("\u4FEE\u6539\u670D\u52A1\u5668\u914D\u7F6E\u6210\u529F"),f.abrupt("return",!0);case 9:case"end":return f.stop()}},l)}));return function(l){return v.apply(this,arguments)}}(),children:(0,a.jsx)(I.Z,{tooltip:"\u8BBE\u7F6E\u5BBF\u4E3B\u673A\u7684Ip\u6216\u662F\u57DF\u540D\uFF0C\u7528\u4E8E\u901A\u8FC7\u7AEF\u53E3\u7684\u5F62\u5F0F\u8BBF\u95EE\u5BB9\u5668\u3002\u652F\u6301IpV4\u53CAIpV6",label:"\u670D\u52A1\u5668Ip\u6216\u57DF\u540D",name:"serverIp",placeholder:"\u4F8B\u5982:192.168.1.25\u30012001:db8:1::2\u3001example.com"})})})]})})}}}]);
