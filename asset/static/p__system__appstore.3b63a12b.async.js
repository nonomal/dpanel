"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3917],{80821:function(K,j,e){e.d(j,{Z:function(){return M}});var C=e(5574),o=e.n(C),y=e(24963),d=e(86738),g=e(14726),A=e(83062),S=e(67294),f=e(85893);function M(r){var Z=(0,S.useState)(!1),U=o()(Z,2),B=U[0],F=U[1],x=(0,S.useContext)(y.Z),P=x.lang,$=x.notice,i=x.message,a=function(){F(!0),r.action().then(function(t){if(F(!1),typeof r.onSuccess=="function"&&r.onSuccess(t),r.messageSuccess){var O="";typeof r.messageSuccess=="function"?O=r.messageSuccess(t):O=r.messageSuccess,O.indexOf(".")>-1&&(O=P(O)),r.asynced?i.info(O):i.success(O)}}).catch(function(t){F(!1),typeof r.onError=="function"&&r.onError(t)})};return r.confirm?(0,f.jsx)(d.Z,{style:{width:500},title:r.confirmTitle?r.confirmTitle:P("notification.title.tip"),description:r.confirm,onConfirm:a,okText:"Yes",cancelText:"No",children:(0,f.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:B,danger:r.danger,type:r.type,children:r.children})}):(0,f.jsx)(A.Z,{title:r.tips,children:(0,f.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:B,onClick:a,danger:r.danger,type:r.type,children:r.children})})}},24963:function(K,j,e){var C=e(67294),o=(0,C.createContext)({});j.Z=o},29337:function(K,j,e){e.r(j),e.d(j,{default:function(){return ee}});var C=e(15009),o=e.n(C),y=e(99289),d=e.n(y),g=e(5574),A=e.n(g),S=e(24963),f=e(15078),M=e(184),r=e(5966),Z=e(97462),U=e(86615),B=e(62370),F=e(54006),x=e(14726),P=e(42075),$=e(25593),i=e(66309),a=e(67294),n=e(85893),t=(0,a.forwardRef)(function(h,z){var w=(0,a.useState)(!1),b=A()(w,2),p=b[0],u=b[1],R=(0,a.useRef)(),T=(0,a.useContext)(S.Z),c=T.message,E=T.notice,s=(0,F.useSearchParams)(),v=A()(s,2),ne=v[0],te=v[1];return(0,a.useImperativeHandle)(z,function(){return{edit:function(m){var l;(l=R.current)===null||l===void 0||l.setFieldsValue({title:m.title,name:m.name,type:m.setting.type,url:m.setting.url,id:m.id}),u(!0)}}}),(0,a.useEffect)(function(){ne.get("op")=="create"&&u(!0)},[]),(0,n.jsxs)(M.a,{name:"create",title:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97",open:p,onOpenChange:function(m){u(m)},drawerProps:{forceRender:!0},formRef:R,trigger:(0,n.jsx)(x.ZP,{type:"primary",children:"\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97"}),onFinish:function(){var L=d()(o()().mark(function m(l){var D,I,W;return o()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,f.ks)({name:l.name,url:l.url,type:l.type});case 2:if(D=_.sent,!(D&&D.data)){_.next=12;break}return _.next=6,(0,f.$c)({id:l.id,name:l.name,title:l.title,type:l.type,url:l.url,apps:D.data.list});case 6:if(I=_.sent,!(I&&I.data)){_.next=12;break}return c.success("\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\u6210\u529F"),h.onFinish&&h.onFinish(),(W=R.current)===null||W===void 0||W.resetFields(),_.abrupt("return",!0);case 12:case"end":return _.stop()}},m)}));return function(m){return L.apply(this,arguments)}}(),children:[(0,n.jsx)(r.Z,{name:"id",hidden:!0}),(0,n.jsx)(r.Z,{label:"\u540D\u79F0",name:"title",required:!0,rules:[{required:!0}],placeholder:"\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u5E94\u7528\u5546\u5E97"}),(0,n.jsx)(Z.Z,{name:["id"],children:function(m){var l=m.id;return(0,n.jsx)(r.Z,{label:"\u6807\u8BC6",name:"name",required:!0,disabled:!!l,rules:[{required:!0}],placeholder:"\u6307\u5B9A\u5546\u5E97\u6807\u8BC6\uFF0C\u7528\u4E8E\u521B\u5EFA\u5546\u5E97\u6587\u4EF6\u5B58\u50A8\u76EE\u5F55"})}}),(0,n.jsx)(U.Z.Group,{name:"type",label:"\u5546\u5E97\u7C7B\u578B",valueEnum:{casaos:"casaos \u5E94\u7528\u5546\u5E97","1panel":"1panel \u5E94\u7528\u5546\u5E97"},fieldProps:{onChange:function(m){var l;(l=R.current)===null||l===void 0||l.resetFields(["url"])}}}),(0,n.jsx)(Z.Z,{name:["type"],children:function(m){var l=m.type,D=[],I=[];if(l=="1panel"&&(I=["https://gitee.com/qyg2297248353/appstore-dpanel","https://github.com/1Panel-dev/appstore","https://github.com/okxlin/appstore"],D=[(0,n.jsx)(r.Z,{label:"\u4ED3\u5E93\u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B git \u4ED3\u5E93\u5730\u5740"},"gitUrl")]),l=="portainer"&&(D=[(0,n.jsx)(r.Z,{label:"template.json \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"https://github.com/Lissy93/portainer-templates/blob/main/templates.json"},"jsonUrl")]),l=="casaos"&&(I=["https://play.cuse.eu.org/Cp0204-AppStore-Play.zip"],D=[(0,n.jsx)(r.Z,{label:"zip \u5730\u5740",name:"url",required:!0,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B zip \u5730\u5740"},"zipUrl")]),l&&l!="")return[D,(0,n.jsx)(B.Z,{label:(0,n.jsxs)(P.Z,{children:["\u63A8\u8350\u5546\u5E97",(0,n.jsx)("a",{href:"https://dpanel.cc/#/zh-cn/manual/setting/store?id=%e6%94%af%e6%8c%81%e7%b1%bb%e5%9e%8b",target:"_blank",children:"\u4E09\u65B9\u5546\u5E97\u63A5\u5165\u8BF4\u660E"})]}),children:(0,n.jsx)(P.Z,{wrap:!0,children:I.map(function(W,V){return(0,n.jsx)($.Z.Link,{onClick:function(){var G;(G=R.current)===null||G===void 0||G.setFieldValue("url",W)},children:(0,n.jsx)(i.Z,{color:"cyan",children:W})},V)})})},"recommend")]}})]})}),O=t,N=e(80821),J=e(67255),H=e(43425),Y=e(98165),Q=e(90078),X=e(10641),k=e(96074),q=e(83062);function ee(){var h=(0,a.useRef)(),z=(0,F.useAccess)(),w=(0,a.useRef)();return(0,n.jsx)(Q._z,{header:{extra:[z.canSeeFounder&&(0,n.jsx)(O,{ref:w,onFinish:function(){var p,u;!((p=h.current)===null||p===void 0)&&p.reloadAndRest&&((u=h.current)===null||u===void 0||u.reloadAndRest())}},"create")]},children:(0,n.jsx)(X.Z,{scroll:{x:"max-content"},rowKey:"id",pagination:(0,J.O)(),columns:[{title:"\u6807\u8BC6",dataIndex:"name",width:200},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u5730\u5740",width:500,search:!1,render:function(p,u,R,T,c){return(0,n.jsx)("a",{href:u.setting.url,target:"_blank",children:(0,n.jsx)(i.Z,{children:u.setting.url})})}},{title:"\u6700\u540E\u66F4\u65B0",render:function(p,u,R,T,c){if(u.setting.updatedAt)return new Date(u.setting.updatedAt*1e3).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(p,u,R,T,c){return(0,n.jsxs)(P.Z,{split:(0,n.jsx)(k.Z,{type:"vertical"}),children:[(0,n.jsx)($.Z.Link,{onClick:function(){var s;(s=w.current)===null||s===void 0||s.edit(u)},children:(0,n.jsx)(q.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(H.Z,{})})},"manage"),(0,n.jsx)(N.Z,{type:"link",icon:(0,n.jsx)(Y.Z,{}),action:function(){var s,v;return(0,f.ks)({id:u.id,name:u.name,url:(s=u.setting.url)!==null&&s!==void 0?s:"",type:(v=u.setting.type)!==null&&v!==void 0?v:""})},onSuccess:function(){var s,v;return!((s=h.current)===null||s===void 0)&&s.reloadAndRest&&((v=h.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var s,v;return!((s=h.current)===null||s===void 0)&&s.reloadAndRest&&((v=h.current)===null||v===void 0||v.reloadAndRest()),!0},messageSuccess:"\u66F4\u65B0\u6210\u529F",children:" "},"upgrade")]})}}],request:function(){var b=d()(o()().mark(function p(u,R,T){var c;return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,f.eO)({name:u.name,title:u.title});case 2:return c=s.sent,s.abrupt("return",{data:c.data.list,success:!0,total:c.data.list.length});case 4:case"end":return s.stop()}},p)}));return function(p,u,R){return b.apply(this,arguments)}}(),rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:h,tableAlertOptionRender:function(p){var u=p.selectedRowKeys,R=p.selectedRows;return(0,n.jsx)(P.Z,{size:16,children:(0,n.jsx)(N.Z,{danger:!0,type:"primary",action:function(){return(0,f.Me)({id:R.map(function(c){return c.id})})},onSuccess:function(){var c,E;return!((c=h.current)===null||c===void 0)&&c.reloadAndRest&&((E=h.current)===null||E===void 0||E.reloadAndRest()),!0},onError:function(){var c,E;return!((c=h.current)===null||c===void 0)&&c.reset&&((E=h.current)===null||E===void 0||E.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"},"delete")})}})})}},15078:function(K,j,e){e.d(j,{$c:function(){return A},Me:function(){return F},eO:function(){return U},ks:function(){return f},yL:function(){return P}});var C=e(15009),o=e.n(C),y=e(99289),d=e.n(y),g=e(54006);function A(i){return S.apply(this,arguments)}function S(){return S=d()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/create",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),S.apply(this,arguments)}function f(i){return M.apply(this,arguments)}function M(){return M=d()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/sync",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),M.apply(this,arguments)}function r(i){return Z.apply(this,arguments)}function Z(){return Z=_asyncToGenerator(_regeneratorRuntime().mark(function i(a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),Z.apply(this,arguments)}function U(i){return B.apply(this,arguments)}function B(){return B=d()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)("/api/common/store/get-list",{method:"POST",data:a}));case 1:case"end":return t.stop()}},i)})),B.apply(this,arguments)}function F(i){return x.apply(this,arguments)}function x(){return x=d()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,g.request)("/api/common/store/delete",{method:"POST",data:a});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},i)})),x.apply(this,arguments)}function P(i){return $.apply(this,arguments)}function $(){return $=d()(o()().mark(function i(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.request)(a==null?void 0:a.path,{method:"GET"}));case 1:case"end":return t.stop()}},i)})),$.apply(this,arguments)}},67255:function(K,j,e){e.d(j,{O:function(){return C},j:function(){return o}});function C(){var y,d=parseInt((y=localStorage.getItem("dpanel-pagesize"))!==null&&y!==void 0?y:"0");return{showSizeChanger:!0,defaultPageSize:d!=null?d:20}}function o(y){var d="dpanel-table-column-".concat(y),g={};if(localStorage.getItem(d)){var A;g=JSON.parse((A=localStorage.getItem(d))!==null&&A!==void 0?A:"{}")}return{defaultValue:g,onChange:function(f){localStorage.setItem("dpanel-table-column-".concat(y),JSON.stringify(f))}}}}}]);
