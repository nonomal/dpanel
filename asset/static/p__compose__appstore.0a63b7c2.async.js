"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{80821:function(ee,T,t){t.d(T,{Z:function(){return P}});var b=t(5574),r=t.n(b),W=t(24963),l=t(86738),c=t(14726),K=t(83062),O=t(67294),A=t(85893);function P(o){var j=(0,O.useState)(!1),R=r()(j,2),E=R[0],B=R[1],C=(0,O.useContext)(W.Z),w=C.lang,Z=C.notice,u=C.message,p=function(){B(!0),o.action().then(function(a){if(B(!1),typeof o.onSuccess=="function"&&o.onSuccess(a),o.messageSuccess){var D="";typeof o.messageSuccess=="function"?D=o.messageSuccess(a):D=o.messageSuccess,D.indexOf(".")>-1&&(D=w(D)),o.asynced?u.info(D):u.success(D)}}).catch(function(a){B(!1),typeof o.onError=="function"&&o.onError(a)})};return o.confirm?(0,A.jsx)(l.Z,{style:{width:500},title:o.confirmTitle?o.confirmTitle:w("notification.title.tip"),description:o.confirm,onConfirm:p,okText:"Yes",cancelText:"No",children:(0,A.jsx)(c.ZP,{disabled:o.disabled,icon:o.icon,loading:E,danger:o.danger,type:o.type,children:o.children})}):(0,A.jsx)(K.Z,{title:o.tips,children:(0,A.jsx)(c.ZP,{disabled:o.disabled,icon:o.icon,loading:E,onClick:p,danger:o.danger,type:o.type,children:o.children})})}},24963:function(ee,T,t){var b=t(67294),r=(0,b.createContext)({});T.Z=r},43774:function(ee,T,t){t.r(T),t.d(T,{default:function(){return le}});var b=t(5574),r=t.n(b),W=t(24963),l=t(15078),c=t(90078),K=t(97269),O=t(62370),A=t(97462),P=t(38345),o=t(45360),j=t(42075),R=t(65233),E=t(14726),B=t(92398),C=t(2487),w=t(32983),Z=t(4393),u=t(67294),p=t(15009),x=t.n(p),a=t(99289),D=t.n(a),V=t(184),Y=t(51652),I=t(71230),M=t(15746),Q=t(34041),re=t(29158),X=t(74842),ne=t(25593),k=t(83062),s=t(66309),e=t(85893);function _(i){var $=(0,u.useState)(),L=r()($,2),h=L[0],F=L[1];return(0,u.useEffect)(function(){var G=i.url.substring(0,i.url.indexOf("://"));switch(G){case"image":F((0,e.jsx)("img",{width:i.imageSize?i.imageSize.width:"auto",height:i.imageSize?i.imageSize.height:"auto",src:i.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":F((0,e.jsx)("img",{width:i.imageSize?i.imageSize.width:"auto",height:i.imageSize?i.imageSize.height:"auto",src:i.url}));break;case"markdown-file":(0,l.yL)({path:i.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(N){F((0,e.jsx)(Y.Z,{source:N,style:{padding:5}},"content"))});break;case"markdown":F((0,e.jsx)(Y.Z,{source:i.url.replace("markdown://",""),style:{padding:5}},"content"));break}},[i.url]),(0,e.jsx)(e.Fragment,{children:h})}function n(i){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z,{gutter:[10,10],children:[(0,e.jsx)(M.Z,{span:6,children:(0,e.jsx)(_,{url:i.app.logo,imageSize:i.logoSize})}),(0,e.jsxs)(M.Z,{span:i.extra?12:18,children:[(0,e.jsx)(I.Z,{children:(0,e.jsx)(M.Z,{span:24,children:(0,e.jsx)(j.Z,{direction:"horizontal",children:(0,e.jsxs)(ne.Z.Title,{level:5,children:[i.app.name,i.app.title]})})})}),(0,e.jsx)(I.Z,{style:{height:"60px"},children:(0,e.jsx)(M.Z,{children:(0,e.jsx)(k.Z,{title:i.app.description,children:(0,e.jsx)(ne.Z.Paragraph,{ellipsis:{rows:2},children:i.app.description})})})}),(0,e.jsx)(I.Z,{style:{height:"30px"},children:(0,e.jsx)(M.Z,{children:i.app.tag&&i.app.tag.map(function($,L){return(0,e.jsx)(s.Z,{children:$},L)})})})]}),(0,e.jsx)(M.Z,{span:i.extra?6:0,children:i.extra})]})})}var se=t(80821),ue=t(90098),ae=t(54006),ie=(0,u.forwardRef)(function(i,$){var L=(0,u.useState)(!1),h=r()(L,2),F=h[0],G=h[1],N=(0,u.useState)(),te=r()(N,2),f=te[0],z=te[1],J=(0,u.useState)(""),H=r()(J,2),v=H[0],m=H[1],U=(0,ae.useNavigate)();return(0,u.useImperativeHandle)($,function(){return{show:function(d){console.log(d),G(!0),z(d),m(Object.keys(d.version)[0])}}}),(0,e.jsx)(V.a,{submitter:!1,open:F,onOpenChange:function(d){G(d)},title:"".concat(f==null?void 0:f.name," \u8BE6\u60C5\u4ECB\u7ECD"),children:f&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(P.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(n,{app:f,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.Z,{gutter:[10,10],children:[(0,e.jsx)(M.Z,{children:(0,e.jsxs)(j.Z,{wrap:!0,children:[(0,e.jsx)(E.ZP,{href:f.website,target:"_blank",icon:(0,e.jsx)(re.Z,{}),children:"\u5B98\u7F51"},"website"),(0,e.jsx)(se.Z,{action:D()(x()().mark(function g(){var d,y;return x()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,(0,ue.iE)({storeId:(d=f.storeId)!==null&&d!==void 0?d:0,name:f.name,composeFile:f.version[v].composeFile,environment:f.version[v].environment});case 2:y=q.sent,y&&y.data.id&&U("/compose/create?id="+y.data.id);case 4:case"end":return q.stop()}},g)})),type:"primary",icon:(0,e.jsx)(X.Z,{}),children:"\u5B89\u88C5"},"install")]})}),(0,e.jsx)(M.Z,{span:24,children:f.version&&(0,e.jsx)(Q.Z,{style:{width:"100%"},value:v,onChange:function(d){m(d)},options:Object.keys(f.version).map(function(g){return{value:g,label:g}})})})]})})})}),Object.keys(f.version).map(function(g){if(!(v!=g||!f.version[g].environment||f.version[g].environment.length==0)){var d=[{name:"%CONTAINER_DEFAULT_NAME%",value:"-",label:"\u4F7F\u7528 Compose \u9ED8\u8BA4\u5BB9\u5668\u540D\u79F0"}],y=`## DPanel \u9762\u677F\u5185\u7F6E\u53D8\u91CF 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`;return d.map(function(S){y+="|".concat(S.name,"|").concat(S.value,"|").concat(S.label,`| 
`)}),y+="## \u7248\u672C\u4FE1\u606F <sup>".concat(g,`</sup> 
 |\u53D8\u91CF\u540D|\u9ED8\u8BA4\u503C|\u8BF4\u660E| 
 |---|---|---|
`),f.version[g].environment.map(function(S){y+="|".concat(S.name,"|").concat(S.value,"|").concat(S.label,`| 
`)}),y+="<br />",(0,e.jsx)(Y.Z,{source:y,style:{padding:5}},g)}}),(0,e.jsx)(_,{url:f==null?void 0:f.content})]})})}),oe=ie;function le(){var i=(0,u.useRef)(),$=(0,u.useState)(),L=r()($,2),h=L[0],F=L[1],G=(0,u.useContext)(W.Z),N=G.loading,te=(0,u.useState)(""),f=r()(te,2),z=f[0],J=f[1];(0,u.useEffect)(function(){N.show(),(0,l.eO)().then(function(v){F(Object.fromEntries(v.data.list.map(function(m){return[m.name,m]}))),v.data.list.length>0&&J(v.data.list[0].name)}).finally(function(){N.destroy()})},[]);var H=function(m){var U=[];if(h){if(h["search"+m])return;var g={};Object.keys(h).map(function(d){h[d].id!=-1&&(g[d]=h[d]),h[d].setting.apps.map(function(y){if(m&&y.name.toLowerCase().indexOf(m)!==-1){var S=JSON.parse(JSON.stringify(y));S.title=" - \u3010".concat(h[d].title,"\u3011"),S.storeId=h[d].id,U.push(S)}})}),U.length>0?(g["search"+m]={id:-1,name:"search"+m,title:"\u641C\u7D22\u7ED3\u679C",setting:{apps:U}},J("search"+m)):(o.ZP.error("\u672A\u80FD\u627E\u5230\u5305\u542B\u5173\u952E\u5B57\u7684\u5E94\u7528"),J(Object.keys(h)[0])),F(g)}};return(0,e.jsxs)(c._z,{extra:[(0,e.jsx)(K.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(m){H(m.search)},children:(0,e.jsxs)(j.Z.Compact,{children:[(0,e.jsx)(O.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(R.Z,{allowClear:!0,addonBefore:"\u5168\u5546\u5E97\u67E5\u8BE2",placeholder:"\u6309\u56DE\u8F66\u67E5\u8BE2\u5E94\u7528",onClear:function(){H("")}})}),(0,e.jsx)(A.Z,{name:["search"],children:function(m){var U=m.search;return(0,e.jsx)(E.ZP,{onClick:function(){H(U)},children:"\u641C\u7D22"})}})]})},"form")],children:[(0,e.jsx)(oe,{ref:i}),(0,e.jsxs)(P.Z,{children:[z!=""&&h&&(0,e.jsx)(B.Z,{activeKey:z,onChange:function(m){J(m)},items:Object.keys(h).map(function(v){return{label:h[v].title,key:v}})}),(0,e.jsx)(C.Z,{locale:{emptyText:(0,e.jsx)(w.Z,{image:w.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(e.Fragment,{children:["\u9762\u677F\u652F\u6301\u591A\u79CD\u7C7B\u578B\u7684\u7B2C\u4E09\u65B9\u5E94\u7528\u5546\u5E97\uFF0C",(0,e.jsx)(ae.Link,{to:"/system/appstore?op=create",children:"\u8BF7\u5148\u6DFB\u52A0\u7B2C\u4E09\u65B9\u5546\u5E97"})]})})},pagination:{pageSize:36},rowKey:"name",grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:h&&h[z]&&h[z].setting.apps,renderItem:function(m,U){return(0,e.jsx)(C.Z.Item,{children:(0,e.jsx)(Z.Z,{onClick:function(){if(h){var d;m.storeId||(m.storeId=h[z].id),(d=i.current)===null||d===void 0||d.show(m)}},hoverable:!0,children:(0,e.jsx)(n,{app:m,logoSize:{width:"50",height:"50"}})})})}})]})]})}},15078:function(ee,T,t){t.d(T,{$c:function(){return K},Me:function(){return B},eO:function(){return R},ks:function(){return A},yL:function(){return w}});var b=t(15009),r=t.n(b),W=t(99289),l=t.n(W),c=t(54006);function K(u){return O.apply(this,arguments)}function O(){return O=l()(r()().mark(function u(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/create",{method:"POST",data:p}));case 1:case"end":return a.stop()}},u)})),O.apply(this,arguments)}function A(u){return P.apply(this,arguments)}function P(){return P=l()(r()().mark(function u(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/sync",{method:"POST",data:p}));case 1:case"end":return a.stop()}},u)})),P.apply(this,arguments)}function o(u){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function u(p){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/common/store/get-detail",{method:"POST",data:p}));case 1:case"end":return a.stop()}},u)})),j.apply(this,arguments)}function R(u){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function u(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)("/api/common/store/get-list",{method:"POST",data:p}));case 1:case"end":return a.stop()}},u)})),E.apply(this,arguments)}function B(u){return C.apply(this,arguments)}function C(){return C=l()(r()().mark(function u(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,c.request)("/api/common/store/delete",{method:"POST",data:p});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},u)})),C.apply(this,arguments)}function w(u){return Z.apply(this,arguments)}function Z(){return Z=l()(r()().mark(function u(p){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,c.request)(p==null?void 0:p.path,{method:"GET"}));case 1:case"end":return a.stop()}},u)})),Z.apply(this,arguments)}},90098:function(ee,T,t){t.d(T,{CT:function(){return R},GG:function(){return x},MG:function(){return M},Oh:function(){return w},Pn:function(){return o},U_:function(){return Y},VN:function(){return D},iE:function(){return ne},ik:function(){return B},im:function(){return K},mg:function(){return u},pm:function(){return A},xC:function(){return re}});var b=t(15009),r=t.n(b),W=t(99289),l=t.n(W),c=t(54006);function K(s){return O.apply(this,arguments)}function O(){return O=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/create",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),O.apply(this,arguments)}function A(s){return P.apply(this,arguments)}function P(){return P=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-list",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),P.apply(this,arguments)}function o(s){return j.apply(this,arguments)}function j(){return j=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-task",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),j.apply(this,arguments)}function R(s){return E.apply(this,arguments)}function E(){return E=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-detail",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),E.apply(this,arguments)}function B(s){return C.apply(this,arguments)}function C(){return C=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/delete",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),C.apply(this,arguments)}function w(s){return Z.apply(this,arguments)}function Z(){return Z=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-deploy",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),Z.apply(this,arguments)}function u(s){return p.apply(this,arguments)}function p(){return p=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-destroy",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),p.apply(this,arguments)}function x(s){return a.apply(this,arguments)}function a(){return a=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-ctrl",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),a.apply(this,arguments)}function D(s){return V.apply(this,arguments)}function V(){return V=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-log",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),V.apply(this,arguments)}function Y(s){return I.apply(this,arguments)}function I(){return I=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/container-process-kill",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),I.apply(this,arguments)}function M(s){return Q.apply(this,arguments)}function Q(){return Q=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/get-from-uri",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),Q.apply(this,arguments)}function re(s){return X.apply(this,arguments)}function X(){return X=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/app/compose/parse",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),X.apply(this,arguments)}function ne(s){return k.apply(this,arguments)}function k(){return k=l()(r()().mark(function s(e){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,c.request)("/api/common/store/deploy",{method:"POST",data:e}));case 1:case"end":return n.stop()}},s)})),k.apply(this,arguments)}}}]);
